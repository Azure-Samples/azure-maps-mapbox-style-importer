/* MIT License - Copyright (c) Microsoft Corporation. */


!function(t,O){"use strict";var e=(f.prototype.addStyle=function(e){var o=this,t=o._map;e.light&&t.setStyle({light:o.convertOptions(e.light)}),e.sources&&Object.keys(e.sources).forEach(function(t){o.addSource(t,e.sources[t])}),e.layers&&e.layers.forEach(function(t){o.addLayer(t)})},f.prototype.addSource=function(t,e){var o=this,a=o._map,i=o.convertOptions(e);switch(e.type){case"image":case"raster":t&&(o.rasterSources[t]=i);break;case"geojson":o.addDataSource(i,e,t);break;case"vector":a.sources.add(new O.source.VectorTileSource(t,i))}},f.prototype.addLayer=function(t,e){var o=this,a=o._map;if(-1<f.supportedMBLayers.indexOf(t.type)){var i,r=t.source;if("string"==typeof r)o.rasterSources[r]&&(r=o.rasterSources[r]);else{var n=o.convertOptions(r);switch(r.type){case"image":case"raster":r=n;break;case"geojson":r=o.addDataSource(l,r);break;case"vector":r=new O.source.VectorTileSource(null,n)}}var s=t.id,l=o.convertOptions(t);switch(t.type){case"circle":i=new O.layer.BubbleLayer(r,s,Object.assign({color:"#000000",radius:5,strokeColor:"#000000",strokeWidth:0},l));break;case"heatmap":i=new O.layer.HeatMapLayer(r,s,l);break;case"line":i=new O.layer.LineLayer(r,s,Object.assign({strokeColor:"#000000",lineCap:"butt",lineJoin:"miter",strokeWidth:2},l));break;case"fill-extrusion":i=new O.layer.PolygonExtrusionLayer(r,s,Object.assign({fillColor:"#000000",fillOpacity:1},l));break;case"fill":i=new O.layer.PolygonLayer(r,s,Object.assign({fillColor:"#000000",fillOpacity:1},l));break;case"symbol":var c=Object.assign({},{iconOptions:{image:"none"},textOptions:{}});l.iconOptions&&Object.assign(c.iconOptions,l.iconOptions),l.textOptions&&Object.assign(c.textOptions,l.textOptions),i=new O.layer.SymbolLayer(r,s,c);break;case"raster":l=Object.assign(l,r),i=r.coordinates?new O.layer.ImageLayer(l,s):new O.layer.TileLayer(l,s)}if(i){if(t.metadata&&(i.metadata=t.metadata),e&&!a.layers.getLayerById(e)){var p=e.toLowerCase();e=0<p.indexOf("label")?"labels":0<p.indexOf("road")?"transit":void 0}a.layers.add(i,e)}}},f.prototype.addDataSource=function(t,e,o){var a=new O.source.DataSource(o,t);return this._map.sources.add(a),e.data&&("string"==typeof e.data?a.importDataFromUrl(e.data):a.add(e.data)),a},f.prototype.convertOptions=function(e){var o={},a=this;return Object.keys(e).forEach(function(t){a.extractOption(t,e,o)}),e.paint&&Object.assign(o,a.convertOptions(e.paint)),e.layout&&Object.assign(o,a.convertOptions(e.layout)),o},f.prototype.extractOption=function(t,e,o){var a=this,i=e[t];switch(t){case"scheme":o.isTMS="tms"===i;break;case"visibility":o.visible="none"!==i;break;case"clusterProperties":o.clusterProperties=i;break;case"tiles":o.tileUrl=i[0];break;case"url":o.tileUrl=i,o.url=i;break;case"text-font":var r=[];i.forEach(function(t){var e=t.toLowerCase(),o="StandardFont";-1<e.indexOf("condensed")&&(o="StandardFontCondensed");var a="Regular";-1<e.indexOf("bold")?a="Bold":-1<e.indexOf("black")?a="Black":-1<e.indexOf("light")&&(a="Light");var i=o+"-"+a;o&&-1==r.indexOf(i)&&r.push(i)}),0<r.length&&(o.textOptions=Object.assign(o.textOptions||{},{font:[r[0]]}));break;case"icon-image":if(!a._map.imageSprite.hasImage(i)){var n=!0;-1<i.indexOf("marker")?n=!(i="marker-blue"):-1<i.indexOf("triangle")||-1<i.indexOf("campsite")?i="triangle":-1<i.indexOf("car")?i="car":-1<i.indexOf("circle")?i="pin-round":-1<i.indexOf("embassy")?i="flag":n=!(i="none"),i&&n&&!a._map.imageSprite.hasImage(i)&&a._map.imageSprite.createFromTemplate(i,i,"#1E90FF","#fff",1).then(function(){})}i&&(o.iconOptions=Object.assign(o.iconOptions||{},{image:i}));break;default:var s=f.mbToAzName[t];if(s||(s=a.mbNameToCamelCase(t),t.startsWith("text-")?s=s.replace("text","textOptions-"):t.startsWith("icon-")&&(s=s.replace("icon","iconOptions-"))),s)if(-1<s.indexOf("-")){var l=s.split("-");o[l[0]]||(o[l[0]]={}),o[l[0]][l[1]]=i}else o[s]=i}},f.prototype.mbNameToCamelCase=function(t){var e=t.indexOf("-");return-1<e&&(t=t.substr(e+1)),t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})},f.supportedMBLayers=["circle","fill","fill-extrusion","line","heatmap","raster","symbol"],f.supportedMBSources=["vector","raster","geojson","image"],f.mbToAzName={"source-layer":"sourceLayer",minzoom:"minZoom",maxzoom:"maxZoom","raster-brightness-min":"minBrightness","raster-brightness-max":"maxBrightness","line-cap":"lineCap","line-color":"strokeColor","line-dasharray":"strokeDashArray","line-width":"strokeWidth","line-gradient":"strokeGradient","line-join":"lineJoin","line-opacity":"strokeOpacity","fill-color":"fillColor","fill-opacity":"fillOpacity","fill-pattern":"fillPattern","fill-extrusion-base":"base","fill-extrusion-height":"height","fill-extrusion-color":"fillColor","fill-extrusion-opacity":"fillOpacity","fill-extrusion-pattern":"fillPattern","fill-extrusion-translate":"translate","fill-extrusion-translate-anchor":"translateAnchor","fill-extrusion-vertical-gradient":"verticalGradient","circle-stroke-color":"strokeColor","circle-stroke-opacity":"strokeOpacity","circle-stroke-width":"strokeWidth","symbol-spacing":"lineSpacing","symbol-placement":"placement","icon-allow-overlap":"iconOptions-allowOverlap","icon-anchor":"iconOptions-anchor","icon-ignore-placement":"iconOptions-ignorePlacement","icon-image":"iconOptions-image","icon-offset":"iconOptions-offset","icon-opacity":"iconOptions-opacity","icon-optional":"iconOptions-optional","icon-pitch-alignment":"iconOptions-pitchAlignment","icon-rotate":"iconOptions-rotation","icon-rotation-alignment":"iconOptions-rotationAlignment","text-allow-overlap":"textOptions-allowOverlap","text-anchor":"textOptions-anchor","text-color":"textOptions-color","text-halo-blur":"textOptions-haloBlur","text-halo-color":"textOptions-haloColor","text-halo-width":"textOptions-haloWidth","text-ignore-placement":"textOptions-ignorePlacement","text-offset":"textOptions-offset","text-opacity":"textOptions-opacity","text-optional":"textOptions-optional","text-pitch-alignment":"textOptions-pitchAlignment","text-rotate":"textOptions-rotation","text-rotation-alignment":"textOptions-rotationAlignment","text-size":"textOptions-size","text-field":"textOptions-textField"},f);function f(t){this.rasterSources={},this._map=t}t.MapboxStyleImporter=e}(this.atlas=this.atlas||{},atlas);
