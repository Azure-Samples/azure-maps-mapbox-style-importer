/* MIT License - Copyright (c) Microsoft Corporation. */


!function(t,O){"use strict";var e=(f.prototype.addStyle=function(e){var o=this,t=o._map;e.light&&t.setStyle({light:o._convertOptions(e.light)}),e.sources&&Object.keys(e.sources).forEach(function(t){o.addSource(t,e.sources[t])}),e.layers&&e.layers.forEach(function(t){o.addLayer(t)})},f.prototype.addSource=function(t,e){var o=this,i=o._map,a=o._convertOptions(e);switch(e.type){case"image":case"raster":t&&(o.rasterSources[t]=a);break;case"geojson":o._addDataSource(a,e,t);break;case"vector":i.sources.add(new O.source.VectorTileSource(t,a))}},f.prototype.addLayer=function(t,e){var o=this,i=o._map;if(-1<f.supportedMBLayers.indexOf(t.type)){var a,n=t.source;if("string"==typeof n)o.rasterSources[n]&&(n=o.rasterSources[n]);else{var r=o._convertOptions(n);switch(n.type){case"image":case"raster":n=r;break;case"geojson":n=o._addDataSource(l,n);break;case"vector":n=new O.source.VectorTileSource(null,r)}}var s=t.id,l=o._convertOptions(t);switch(t.type){case"circle":a=new O.layer.BubbleLayer(n,s,Object.assign({color:"#000000",radius:5,strokeColor:"#000000",strokeWidth:0},l));break;case"heatmap":a=new O.layer.HeatMapLayer(n,s,l);break;case"line":a=new O.layer.LineLayer(n,s,Object.assign({strokeColor:"#000000",lineCap:"butt",lineJoin:"miter",strokeWidth:2},l));break;case"fill-extrusion":a=new O.layer.PolygonExtrusionLayer(n,s,Object.assign({fillColor:"#000000",fillOpacity:1},l));break;case"fill":a=new O.layer.PolygonLayer(n,s,Object.assign({fillColor:"#000000",fillOpacity:1},l));break;case"symbol":var c=Object.assign({},{iconOptions:{image:"none"},textOptions:{}});l.iconOptions&&Object.assign(c.iconOptions,l.iconOptions),l.textOptions&&Object.assign(c.textOptions,l.textOptions),a=new O.layer.SymbolLayer(n,s,c);break;case"raster":l=Object.assign(l,n),a=n.coordinates?new O.layer.ImageLayer(l,s):new O.layer.TileLayer(l,s)}if(a){if(t.metadata&&(a.metadata=t.metadata),e&&!i.layers.getLayerById(e)){var p=e.toLowerCase();e=0<p.indexOf("label")?"labels":0<p.indexOf("road")?"transit":void 0}return i.layers.add(a,e),a}}return null},f.prototype.setLayerOptions=function(t,e){if(t){var o="string"==typeof t?this._map.layers.getLayerById(t):t;if(o.setOptions){var i=this._convertOptions(e);o.setOptions(i)}}},f.prototype._addDataSource=function(t,e,o){var i=new O.source.DataSource(o,t);return this._map.sources.add(i),e.data&&("string"==typeof e.data?i.importDataFromUrl(e.data):i.add(e.data)),i},f.prototype._convertOptions=function(e){var o={},i=this;return Object.keys(e).forEach(function(t){i._extractOption(t,e,o)}),e.paint&&Object.assign(o,i._convertOptions(e.paint)),e.layout&&Object.assign(o,i._convertOptions(e.layout)),o},f.prototype._extractOption=function(t,e,o){var i=this,a=e[t];switch(t){case"scheme":o.isTMS="tms"===a;break;case"visibility":o.visible="none"!==a;break;case"clusterProperties":o.clusterProperties=a;break;case"tiles":o.tileUrl=a[0];break;case"url":o.tileUrl=a,o.url=a;break;case"text-font":var n=[];a.forEach(function(t){var e=t.toLowerCase(),o="StandardFont";-1<e.indexOf("condensed")&&(o="StandardFontCondensed");var i="Regular";-1<e.indexOf("bold")?i="Bold":-1<e.indexOf("black")?i="Black":-1<e.indexOf("light")&&(i="Light");var a=o+"-"+i;o&&-1==n.indexOf(a)&&n.push(a)}),0<n.length&&(o.textOptions=Object.assign(o.textOptions||{},{font:[n[0]]}));break;case"icon-image":if(!i._map.imageSprite.hasImage(a)){var r=!0;-1<a.indexOf("marker")?r=!(a="marker-blue"):-1<a.indexOf("triangle")||-1<a.indexOf("campsite")?a="triangle":-1<a.indexOf("car")?a="car":-1<a.indexOf("circle")?a="pin-round":-1<a.indexOf("embassy")?a="flag":r=!(a="none"),a&&r&&!i._map.imageSprite.hasImage(a)&&i._map.imageSprite.createFromTemplate(a,a,"#1E90FF","#fff",1).then(function(){})}a&&(o.iconOptions=Object.assign(o.iconOptions||{},{image:a}));break;case"iconOptions":o.iconOptions=Object.assign(o.iconOptions||{},a||{});break;case"textOptions":o.textOptions=Object.assign(o.textOptions||{},a||{});break;default:var s=f.mbToAzName[t];if(s||(s=i._mbNameToCamelCase(t),t.startsWith("text-")?s=s.replace("text","textOptions-"):t.startsWith("icon-")&&(s=s.replace("icon","iconOptions-"))),s)if(-1<s.indexOf("-")){var l=s.split("-");o[l[0]]||(o[l[0]]={}),o[l[0]][l[1]]=a}else o[s]=a}},f.prototype._mbNameToCamelCase=function(t){var e=t.indexOf("-");return-1<e&&(t=t.substr(e+1)),t.toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()})},f.supportedMBLayers=["circle","fill","fill-extrusion","line","heatmap","raster","symbol"],f.supportedMBSources=["vector","raster","geojson","image"],f.mbToAzName={"source-layer":"sourceLayer",minzoom:"minZoom",maxzoom:"maxZoom","raster-brightness-min":"minBrightness","raster-brightness-max":"maxBrightness","line-cap":"lineCap","line-color":"strokeColor","line-dasharray":"strokeDashArray","line-width":"strokeWidth","line-gradient":"strokeGradient","line-join":"lineJoin","line-opacity":"strokeOpacity","fill-color":"fillColor","fill-opacity":"fillOpacity","fill-pattern":"fillPattern","fill-extrusion-base":"base","fill-extrusion-height":"height","fill-extrusion-color":"fillColor","fill-extrusion-opacity":"fillOpacity","fill-extrusion-pattern":"fillPattern","fill-extrusion-translate":"translate","fill-extrusion-translate-anchor":"translateAnchor","fill-extrusion-vertical-gradient":"verticalGradient","circle-stroke-color":"strokeColor","circle-stroke-opacity":"strokeOpacity","circle-stroke-width":"strokeWidth","symbol-spacing":"lineSpacing","symbol-placement":"placement","icon-allow-overlap":"iconOptions-allowOverlap","icon-anchor":"iconOptions-anchor","icon-ignore-placement":"iconOptions-ignorePlacement","icon-image":"iconOptions-image","icon-offset":"iconOptions-offset","icon-opacity":"iconOptions-opacity","icon-optional":"iconOptions-optional","icon-pitch-alignment":"iconOptions-pitchAlignment","icon-rotate":"iconOptions-rotation","icon-rotation-alignment":"iconOptions-rotationAlignment","text-allow-overlap":"textOptions-allowOverlap","text-anchor":"textOptions-anchor","text-color":"textOptions-color","text-halo-blur":"textOptions-haloBlur","text-halo-color":"textOptions-haloColor","text-halo-width":"textOptions-haloWidth","text-ignore-placement":"textOptions-ignorePlacement","text-offset":"textOptions-offset","text-opacity":"textOptions-opacity","text-optional":"textOptions-optional","text-pitch-alignment":"textOptions-pitchAlignment","text-rotate":"textOptions-rotation","text-rotation-alignment":"textOptions-rotationAlignment","text-size":"textOptions-size","text-field":"textOptions-textField"},f);function f(t){this.rasterSources={},this._map=t}t.MapboxStyleImporter=e}(this.atlas=this.atlas||{},atlas);
